<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>House of Sisuu ‚Äî Shop Sarees, Jewelry & More</title>
  <meta name="description" content="Shop handwoven sarees, anti‚Äëtarnish jewelry, lehengas, and handcrafted accessories at House of Sisuu. Fast support. Limited editions."/>
  <meta property="og:title" content="House of Sisuu ‚Äî Shop Now" />
  <meta property="og:description" content="Discover curated sarees & jewelry. Fashion with a purpose." />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="en_IN" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { serif: ['Playfair Display','serif'], sans: ['Inter','system-ui','sans-serif'] },
          colors: { sisuu: { bg:'#FAF7F2', ink:'#1E1B16', gold:'#B88946', soft:'#EFE7DB', accent:'#8B5E2E' } },
          boxShadow: { soft:'0 10px 30px -12px rgba(0,0,0,.2)' }
        }
      }
    }
  </script>
  <style>
    html{scroll-behavior:smooth}
    .gold-gradient{background:linear-gradient(135deg,#D9B26E 0%,#B88946 50%,#8C6A2D 100%)}
    .gold-text{background:linear-gradient(135deg,#CFA359,#9B6E2F);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .line-clamp-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
  </style>
</head>
<body class="bg-sisuu-bg text-sisuu-ink font-sans">

  <!-- Top Announcement Bar -->
  <div class="w-full bg-white/80 backdrop-blur border-b border-sisuu-soft text-xs text-center py-2">Limited editions only ‚Ä¢ Free boutique pickup in Malleshwaram ‚Ä¢ Easy WhatsApp support</div>

  <!-- Header -->
  <header class="sticky top-0 z-40 bg-white/90 backdrop-blur border-b border-sisuu-soft">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="h-16 flex items-center gap-4">
        <a href="#home" class="flex items-center gap-2">
          <span class="w-9 h-9 rounded-full gold-gradient grid place-items-center text-white font-serif text-xl">S</span>
          <span class="font-serif text-2xl">Sisuu</span>
        </a>
        <!-- Search -->
        <div class="hidden md:flex flex-1">
          <div class="w-full relative">
            <input id="searchInput" type="search" placeholder="Search sarees, jewelry, colors..." class="w-full rounded-full border border-sisuu-soft/70 pl-12 pr-4 py-2 focus:outline-none focus:ring-2 focus:ring-sisuu-gold/40"/>
            <svg class="w-5 h-5 absolute left-4 top-1/2 -translate-y-1/2 text-neutral-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-4.35-4.35M11 19a8 8 0 1 1 0-16 8 8 0 0 1 0 16Z"/></svg>
          </div>
        </div>
        <!-- Icons -->
        <div class="ml-auto flex items-center gap-4">
          <button id="openWishlist" class="relative p-2 rounded-full hover:bg-neutral-100" title="Wishlist">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.734-.715-1.608-2.377-2.734-4.313-2.734C5.1 3.75 3 5.765 3 8.25c0 7.313 9 12 9 12s9-4.687 9-12Z"/></svg>
            <span id="wishCount" class="hidden absolute -top-1 -right-1 text-[10px] px-1.5 py-0.5 bg-sisuu-gold text-white rounded-full">0</span>
          </button>
          <button class="p-2 rounded-full hover:bg-neutral-100" title="Account">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M15.75 7.5a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.5 20.25a8.25 8.25 0 1 1 16.5 0v.75H4.5v-.75Z"/></svg>
          </button>
          <button id="openCart" class="relative p-2 rounded-full hover:bg-neutral-100" title="Cart">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.436M7.5 14.25h9.75m-9.75 0L6 5.25m1.5 9h10.005c.51 0 .955-.343 1.087-.835l1.527-5.74A1.125 1.125 0 0 0 19.02 6H5.72M7.5 20.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"/></svg>
            <span id="cartCount" class="hidden absolute -top-1 -right-1 text-[10px] px-1.5 py-0.5 bg-sisuu-gold text-white rounded-full">0</span>
          </button>
        </div>
      </div>
      <!-- Category strip -->
      <div class="hidden md:flex items-center gap-6 h-11 text-sm">
        <a href="#shop" class="hover:text-sisuu-gold">Sarees</a>
        <a href="#shop" class="hover:text-sisuu-gold">Jewelry</a>
        <a href="#shop" class="hover:text-sisuu-gold">Lehengas</a>
        <a href="#shop" class="hover:text-sisuu-gold">Suit Sets</a>
        <a href="#shop" class="hover:text-sisuu-gold">Accessories</a>
      </div>
    </div>
  </header>

  <!-- Hero banner -->
  <section id="home" class="relative">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 md:py-14">
      <div class="rounded-3xl overflow-hidden border border-sisuu-soft shadow-soft bg-white grid md:grid-cols-5">
        <div class="md:col-span-3 aspect-[16/9] md:aspect-auto bg-[url('https://images.unsplash.com/photo-1542060748-10c28b62716b?q=80&w=1600&auto=format&fit=crop')] bg-cover bg-center"></div>
        <div class="md:col-span-2 p-8 md:p-10 flex flex-col justify-center">
          <h1 class="font-serif text-4xl leading-tight">Where <span class="gold-text">Elegance</span> Meets Purpose</h1>
          <p class="mt-3 text-neutral-700">Handwoven sarees & handcrafted jewelry. Conscious luxury from Malleshwaram, Bengaluru.</p>
          <div class="mt-6 flex gap-3">
            <a href="#shop" class="inline-flex items-center rounded-full gold-gradient px-6 py-3 text-white shadow-soft">Shop New Arrivals</a>
            <a href="#purpose" class="inline-flex items-center rounded-full border border-sisuu-gold/40 px-6 py-3">Our Purpose</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Shop Section (Myntra-style) -->
  <section id="shop" class="pb-20">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Sort + results -->
      <div class="flex items-center justify-between mb-4">
        <p id="resultCount" class="text-sm text-neutral-600">Showing 0 products</p>
        <div class="flex items-center gap-3">
          <label for="sortSelect" class="text-sm text-neutral-700">Sort by</label>
          <select id="sortSelect" class="text-sm border border-sisuu-soft rounded-md px-2 py-1.5 focus:outline-none focus:ring-2 focus:ring-sisuu-gold/40">
            <option value="pop">Popularity</option>
            <option value="new">New</option>
            <option value="lth">Price: Low to High</option>
            <option value="htl">Price: High to Low</option>
            <option value="disc">Discount</option>
          </select>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-12 gap-6">
        <!-- Filters -->
        <aside class="md:col-span-3 lg:col-span-3 bg-white border border-sisuu-soft rounded-2xl p-5 h-fit sticky top-24">
          <div class="flex items-center justify-between">
            <h3 class="font-semibold">Filters</h3>
            <button id="clearFilters" class="text-xs underline">Clear all</button>
          </div>
          <div class="mt-4 space-y-5 text-sm">
            <!-- Category -->
            <details open>
              <summary class="cursor-pointer font-medium">Category</summary>
              <div class="mt-2 space-y-2" id="catFilter">
                <label class="flex items-center gap-2"><input type="checkbox" value="Saree" class="cat"> Sarees</label>
                <label class="flex items-center gap-2"><input type="checkbox" value="Jewelry" class="cat"> Jewelry</label>
                <label class="flex items-center gap-2"><input type="checkbox" value="Lehenga" class="cat"> Lehengas</label>
                <label class="flex items-center gap-2"><input type="checkbox" value="Suit" class="cat"> Suit Sets</label>
                <label class="flex items-center gap-2"><input type="checkbox" value="Accessory" class="cat"> Accessories</label>
              </div>
            </details>
            <!-- Color -->
            <details open>
              <summary class="cursor-pointer font-medium">Color</summary>
              <div class="mt-2 flex flex-wrap gap-2" id="colorFilter"></div>
            </details>
            <!-- Price -->
            <details open>
              <summary class="cursor-pointer font-medium">Price (‚Çπ)</summary>
              <div class="mt-3">
                <input id="priceMin" type="number" class="w-24 border border-sisuu-soft rounded px-2 py-1" placeholder="Min"/>
                <span class="mx-1">‚Äî</span>
                <input id="priceMax" type="number" class="w-24 border border-sisuu-soft rounded px-2 py-1" placeholder="Max"/>
                <button id="applyPrice" class="ml-2 px-3 py-1.5 text-xs rounded border border-sisuu-gold/50 hover:bg-sisuu-gold hover:text-white">Apply</button>
              </div>
            </details>
            <!-- Discount -->
            <details>
              <summary class="cursor-pointer font-medium">Discount</summary>
              <div class="mt-2 space-y-2" id="discFilter">
                <label class="flex items-center gap-2"><input name="disc" type="radio" value="10"> 10% and above</label>
                <label class="flex items-center gap-2"><input name="disc" type="radio" value="20"> 20% and above</label>
                <label class="flex items-center gap-2"><input name="disc" type="radio" value="30"> 30% and above</label>
                <label class="flex items-center gap-2"><input name="disc" type="radio" value="40"> 40% and above</label>
                <label class="flex items-center gap-2"><input name="disc" type="radio" value="50"> 50% and above</label>
                <label class="flex items-center gap-2"><input name="disc" type="radio" value="" checked> Any</label>
              </div>
            </details>
            <!-- In stock -->
            <label class="flex items-center gap-2"><input id="inStockOnly" type="checkbox"> In stock only</label>
          </div>
        </aside>

        <!-- Product Grid -->
        <main class="md:col-span-9 lg:col-span-9">
          <div id="productGrid" class="grid xs:grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-4 md:gap-6"></div>
          <div class="mt-8 text-center">
            <button id="loadMore" class="px-5 py-2 border border-sisuu-gold/50 rounded-full hover:bg-sisuu-gold hover:text-white">Load more</button>
          </div>
        </main>
      </div>
    </div>
  </section>

  <!-- Purpose + Footer CTA -->
  <section id="purpose" class="py-14 bg-white border-y border-sisuu-soft">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid md:grid-cols-2 gap-8 items-center">
      <div>
        <h2 class="font-serif text-3xl">Fashion with a Purpose</h2>
        <p class="mt-3 text-neutral-700">A portion of every order supports animal care and artisan welfare. Thank you for choosing conscious luxury.</p>
      </div>
      <div class="text-right">
        <a href="#shop" class="inline-flex items-center rounded-full gold-gradient px-6 py-3 text-white shadow-soft">Continue Shopping</a>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="py-10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid md:grid-cols-4 gap-8">
        <div>
          <div class="flex items-center gap-2">
            <span class="w-9 h-9 rounded-full gold-gradient grid place-items-center text-white font-serif text-xl">S</span>
            <span class="font-serif text-xl">House of Sisuu</span>
          </div>
          <p class="mt-3 text-sm text-neutral-600">Handwoven. Heartmade. Humane.</p>
        </div>
        <div class="text-sm">
          <h4 class="font-semibold mb-2">Shop</h4>
          <ul class="space-y-1 text-neutral-700">
            <li><a href="#shop" class="hover:text-sisuu-gold">Sarees</a></li>
            <li><a href="#shop" class="hover:text-sisuu-gold">Jewelry</a></li>
            <li><a href="#shop" class="hover:text-sisuu-gold">Lehengas</a></li>
            <li><a href="#shop" class="hover:text-sisuu-gold">Accessories</a></li>
          </ul>
        </div>
        <div class="text-sm">
          <h4 class="font-semibold mb-2">Support</h4>
          <ul class="space-y-1 text-neutral-700">
            <li><a href="#" class="hover:text-sisuu-gold">Shipping & Returns</a></li>
            <li><a href="#" class="hover:text-sisuu-gold">Care Guide</a></li>
            <li><a href="#" class="hover:text-sisuu-gold">FAQs</a></li>
          </ul>
        </div>
        <div class="text-sm">
          <h4 class="font-semibold mb-2">Contact</h4>
          <p class="text-neutral-700">Malleshwaram, Bengaluru<br>
            <a class="hover:text-sisuu-gold" href="tel:+91XXXXXXXXXX">+91‚ÄëXXXXXXXXXX</a><br>
            <a class="hover:text-sisuu-gold" href="mailto:hello@sisuu.in">hello@sisuu.in</a></p>
        </div>
      </div>
      <div class="mt-8 border-t border-sisuu-soft pt-6 text-xs text-neutral-500 flex flex-wrap items-center justify-between gap-4">
        <p>¬© <span id="year"></span> House of Sisuu ‚Äî Fashion with a Purpose</p>
        <div class="flex gap-4">
          <a href="#" class="hover:text-sisuu-gold">Instagram</a>
          <a href="#" class="hover:text-sisuu-gold">Pinterest</a>
          <a href="#" class="hover:text-sisuu-gold">Facebook</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Floating WhatsApp Button -->
  <a id="whBtn" href="https://wa.me/91XXXXXXXXXX?text=Hi%20Sisuu%2C%20I%20want%20to%20shop%20your%20collection" class="fixed right-4 bottom-4 rounded-full shadow-soft bg-green-500 text-white px-4 py-3 text-sm">Chat to Shop</a>

  <!-- Cart Drawer -->
  <aside id="cartDrawer" class="fixed inset-y-0 right-0 w-[380px] max-w-[90vw] bg-white border-l border-sisuu-soft shadow-soft translate-x-full transition-transform z-50 flex flex-col">
    <div class="p-4 border-b border-sisuu-soft flex items-center justify-between">
      <h3 class="font-semibold">Your Bag</h3>
      <button id="closeCart" class="p-2 hover:bg-neutral-100 rounded-full" aria-label="Close">‚úï</button>
    </div>
    <div id="cartItems" class="flex-1 overflow-auto p-4 space-y-4"></div>
    <div class="p-4 border-t border-sisuu-soft">
      <div class="flex items-center justify-between text-sm">
        <span>Subtotal</span>
        <span id="cartSubtotal" class="font-semibold">‚Çπ0</span>
      </div>
      <button id="checkoutBtn" class="mt-3 w-full gold-gradient text-white py-3 rounded-md">Checkout</button>
    </div>
  </aside>

  <!-- Quick View Modal -->
  <div id="quickModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white w-[95vw] max-w-3xl rounded-2xl overflow-hidden shadow-soft">
      <div class="flex items-center justify-between px-4 py-3 border-b border-sisuu-soft">
        <h3 id="qvTitle" class="font-semibold"></h3>
        <button id="closeQv" class="p-2 hover:bg-neutral-100 rounded-full">‚úï</button>
      </div>
      <div class="grid md:grid-cols-2 gap-6 p-5">
        <div id="qvImage" class="aspect-[4/5] rounded-xl bg-neutral-100 bg-cover bg-center"></div>
        <div>
          <div class="flex items-center gap-2 text-sm">
            <span id="qvRating" class="px-2 py-0.5 bg-green-600 text-white rounded">4.5 ‚òÖ</span>
            <span id="qvBadge" class="px-2 py-0.5 bg-sisuu-soft rounded hidden"></span>
          </div>
          <p class="mt-2 text-xl"><span id="qvPrice" class="font-semibold"></span> <span id="qvMrp" class="text-neutral-500 line-through ml-2"></span> <span id="qvOff" class="text-green-700 ml-2"></span></p>
          <div id="qvSizes" class="mt-3 flex flex-wrap gap-2"></div>
          <div class="mt-4 grid grid-cols-2 gap-3">
            <button id="qvAdd" class="gold-gradient text-white py-3 rounded-md">Add to Bag</button>
            <button id="qvWish" class="px-4 py-3 rounded-md border">‚ô°</button>
            <a id="qvWhats" class="col-span-2 text-center border rounded-md py-2" target="_blank">Buy on WhatsApp</a>
          </div>
          <p class="mt-4 text-sm text-neutral-700" id="qvDesc"></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Test status chip -->
  <div id="testStatus" class="fixed left-3 bottom-3 text-xs px-3 py-2 rounded-full bg-neutral-900 text-white opacity-90 shadow-soft">Running tests‚Ä¶</div>

  <script>
  (function(){
    // ---- Config ----
    const CHECKOUT_URL = 'https://example-checkout.sisuu.in'; // TODO: replace with Razorpay/Shopify checkout link
    const BUSINESS_PHONE = '91XXXXXXXXXX'; // WhatsApp phone; include country code
    
    // Helpers
    const el = (sel, root=document) => root.querySelector(sel);
    const els = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const money = n => `‚Çπ${n.toLocaleString('en-IN')}`;

    // Catalog (mock)
    const PRODUCTS = [
      {id:'SR001', title:'Bishnupuri Silk ‚Äì Gulabi Glow', cat:'Saree', color:'Pink', price:3499, mrp:4999, rating:4.6, badge:'New', stock:8, img:'https://images.unsplash.com/photo-1602471615287-8d5a2a1f7454?q=80&w=1200&auto=format&fit=crop', sizes:['Free'], desc:'Handwoven Bishnupuri silk with soft sheen and fluid drape.'},
      {id:'SR002', title:'Soft Jamdani ‚Äì Nilaya', cat:'Saree', color:'Blue', price:2899, mrp:3899, rating:4.4, badge:'Limited', stock:3, img:'https://images.unsplash.com/photo-1585247226801-bc613c88c4ea?q=80&w=1200&auto=format&fit=crop', sizes:['Free'], desc:'Lightweight Jamdani for all‚Äëday comfort and grace.'},
      {id:'JW101', title:'Anti‚ÄëTarnish Jhumka ‚Äì Kesar', cat:'Jewelry', color:'Gold', price:799, mrp:1299, rating:4.7, badge:'Bestseller', stock:25, img:'https://images.unsplash.com/photo-1543294001-f7cd5d7fb516?q=80&w=1200&auto=format&fit=crop', sizes:['Std'], desc:'Nickel‚Äëfree, skin‚Äësafe, long‚Äëlasting finish.'},
      {id:'AC501', title:'Handcrafted Potli ‚Äì Zari Bloom', cat:'Accessory', color:'Beige', price:1199, mrp:1799, rating:4.3, badge:'New', stock:12, img:'https://images.unsplash.com/photo-1545239351-1141bd82e8a6?q=80&w=1200&auto=format&fit=crop', sizes:['One'], desc:'Potli with zari work, perfect for festive looks.'},
      {id:'SR003', title:'Rajshahi Silk ‚Äì Deep Maroon', cat:'Saree', color:'Maroon', price:4599, mrp:6499, rating:4.8, badge:'Premium', stock:5, img:'https://images.unsplash.com/photo-1578230035193-89d0b9d62c20?q=80&w=1200&auto=format&fit=crop', sizes:['Free'], desc:'Rich texture with classic Banarasi‚Äëstyle motifs.'},
      {id:'LE301', title:'Lehenga Set ‚Äì Pista Haze', cat:'Lehenga', color:'Green', price:7999, mrp:10999, rating:4.5, badge:'Festive', stock:2, img:'https://images.unsplash.com/photo-1623407947981-5b1c100b27a6?q=80&w=1200&auto=format&fit=crop', sizes:['S','M','L'], desc:'Light, twirl‚Äëworthy silhouette with minimal embroidery.'},
      {id:'SU401', title:'Suit Set ‚Äì Ivory Ikat', cat:'Suit', color:'Ivory', price:2499, mrp:3499, rating:4.2, badge:'Limited', stock:7, img:'https://images.unsplash.com/photo-1623407947966-e6c7d626f9ea?q=80&w=1200&auto=format&fit=crop', sizes:['S','M','L','XL'], desc:'Breathable cotton blend with soft lining.'},
      {id:'JW102', title:'Layered Necklace ‚Äì Chandrika', cat:'Jewelry', color:'Silver', price:999, mrp:1499, rating:4.6, badge:'New', stock:10, img:'https://images.unsplash.com/photo-1604335399105-a0f3fb66eac8?q=80&w=1200&auto=format&fit=crop', sizes:['Std'], desc:'Anti‚Äëtarnish, perfect for day‚Äëto‚Äënight styling.'},
      {id:'SR004', title:'Pochampally Ikat ‚Äì Sunlit Ochre', cat:'Saree', color:'Yellow', price:3299, mrp:4799, rating:4.1, badge:'Editor‚Äôs pick', stock:0, img:'https://images.unsplash.com/photo-1595381053534-2d19f6a3a8d2?q=80&w=1200&auto=format&fit=crop', sizes:['Free'], desc:'Striking ikat patterns with a modern palette.'}
    ];

    const COLORS = [...new Set(PRODUCTS.map(p=>p.color))];

    // ---------- State & Persistence ----------
    const state = { q:'', sort:'pop', cats:new Set(), colors:new Set(), pmin:null, pmax:null, disc:null, stock:false, page:1, per:8, wishlist:new Set(), cart:[] };

    // Load wishlist from localStorage (persists across sessions)
    const WL_KEY = 'sisuu_wishlist_v1';
    try { const saved = JSON.parse(localStorage.getItem(WL_KEY)||'[]'); saved.forEach(id=>state.wishlist.add(id)); } catch{}

    function saveWishlist(){ localStorage.setItem(WL_KEY, JSON.stringify([...state.wishlist])); }

    // ---------- UI Build ----------
    const colorWrap = el('#colorFilter');
    COLORS.forEach(c=>{
      const b=document.createElement('button');
      b.className='px-2.5 py-1 rounded-full border text-xs hover:bg-neutral-100';
      b.textContent=c; b.dataset.color=c;
      b.onclick=()=>{ if(state.colors.has(c)) state.colors.delete(c); else state.colors.add(c); b.classList.toggle('bg-neutral-900'); b.classList.toggle('text-white'); render(); };
      colorWrap.appendChild(b);
    });

    el('#searchInput')?.addEventListener('input',e=>{state.q=e.target.value.trim().toLowerCase(); state.page=1; render();});

    els('.cat').forEach(cb=>cb.addEventListener('change',e=>{ const v=e.target.value; e.target.checked?state.cats.add(v):state.cats.delete(v); state.page=1; render(); }));

    els('#discFilter input').forEach(r=>r.addEventListener('change',e=>{ state.disc=e.target.value?Number(e.target.value):null; render(); }));

    el('#inStockOnly').addEventListener('change',e=>{ state.stock=e.target.checked; render(); });

    el('#applyPrice').addEventListener('click',()=>{ state.pmin=Number(el('#priceMin').value)||null; state.pmax=Number(el('#priceMax').value)||null; state.page=1; render(); });

    el('#sortSelect').addEventListener('change',e=>{ state.sort=e.target.value; render(); });

    el('#clearFilters').addEventListener('click',()=>{ state.cats.clear(); state.colors.clear(); els('.cat').forEach(c=>c.checked=false); els('#colorFilter button').forEach(b=>b.classList.remove('bg-neutral-900','text-white')); state.disc=null; els('#discFilter input').forEach(i=>{ if(i.value==='') i.checked=true; else i.checked=false; }); state.pmin=null; state.pmax=null; el('#priceMin').value=''; el('#priceMax').value=''; el('#inStockOnly').checked=false; state.q=''; el('#searchInput').value=''; render(); });

    el('#loadMore').addEventListener('click',()=>{ state.page++; render(true); });

    function discount(p){ return Math.round(100 - (p.price/p.mrp)*100); }

    function applyFilters(list){
      return list.filter(p=>{
        if(state.stock && p.stock<=0) return false;
        if(state.cats.size && !state.cats.has(p.cat)) return false;
        if(state.colors.size && !state.colors.has(p.color)) return false;
        if(state.pmin!==null && p.price<state.pmin) return false;
        if(state.pmax!==null && p.price>state.pmax) return false;
        if(state.disc!==null && discount(p)<state.disc) return false;
        if(state.q){ const s=(p.title+ ' '+ p.cat+' '+p.color).toLowerCase(); if(!s.includes(state.q)) return false; }
        return true;
      });
    }

    function sortList(list){
      const arr=[...list];
      if(state.sort==='lth') arr.sort((a,b)=>a.price-b.price);
      else if(state.sort==='htl') arr.sort((a,b)=>b.price-a.price);
      else if(state.sort==='disc') arr.sort((a,b)=>discount(b)-discount(a));
      else if(state.sort==='new') arr.sort((a,b)=> (b.badge==='New') - (a.badge==='New'));
      return arr; // pop = default
    }

    function card(p){
      const d=document.createElement('div');
      d.className='group bg-white border border-sisuu-soft rounded-2xl overflow-hidden shadow-soft';
      d.dataset.price=p.price; d.dataset.discount=discount(p);
      d.innerHTML=`
        <div class="relative">
          <div class="aspect-[4/5] bg-cover bg-center" style="background-image:url('${p.img}')"></div>
          ${p.badge?`<span class="absolute left-2 top-2 text-[10px] px-2 py-0.5 rounded-full bg-black/80 text-white">${p.badge}</span>`:''}
          ${p.stock===0?`<span class="absolute right-2 top-2 text-[10px] px-2 py-0.5 rounded-full bg-red-600 text-white">Sold Out</span>`:''}
          <button class="absolute right-2 bottom-2 bg-white/90 rounded-full p-2 hover:bg-white" title="Quick view">üëÅ</button>
          <button class="absolute right-2 bottom-12 bg-white/90 rounded-full p-2 hover:bg-white" title="Wishlist">${state.wishlist.has(p.id)?'‚ù§Ô∏è':'‚ô°'}</button>
        </div>
        <div class="p-3">
          <h3 class="text-sm font-medium line-clamp-2">${p.title}</h3>
          <div class="mt-1 flex items-center gap-2 text-xs"><span class="px-1.5 py-0.5 rounded bg-green-600 text-white">${p.rating} ‚òÖ</span><span class="text-neutral-500">${p.color}</span></div>
          <div class="mt-1 text-sm"><span class="font-semibold">${money(p.price)}</span> <span class="line-through text-neutral-500 ml-1">${money(p.mrp)}</span> <span class="text-green-700 ml-1">${discount(p)}% OFF</span></div>
          <div class="mt-2 flex gap-2">${(p.sizes||[]).map(s=>`<span class='text-xs border rounded px-2 py-0.5'>${s}</span>`).join('')}</div>
          <button class="mt-3 w-full ${p.stock===0?'border border-sisuu-gold/50 text-sisuu-ink bg-white':'gold-gradient text-white'} py-2 rounded-md">${p.stock===0?'Notify Me':'Add to Bag'}</button>
        </div>`;

      const [qvBtn,wishBtn,ctaBtn]=d.querySelectorAll('button');
      qvBtn.addEventListener('click',()=>openQuick(p));
      wishBtn.addEventListener('click',()=>toggleWish(p,wishBtn));
      ctaBtn.addEventListener('click',()=>{ if(p.stock>0){ addToCart(p); } else { openNotify(p); } });
      return d;
    }

    function render(append=false){
      const list = sortList(applyFilters(PRODUCTS));
      el('#resultCount').textContent = `Showing ${list.length} products`;
      const end=state.page*state.per;
      const slice=list.slice(0,end);
      const grid=el('#productGrid');
      grid.innerHTML='';
      slice.forEach(p=> grid.appendChild(card(p)) );
      el('#loadMore').classList.toggle('hidden', end>=list.length);
      updateWishBadge();
    }

    // Wishlist
    function toggleWish(p,btn){
      if(state.wishlist.has(p.id)){ state.wishlist.delete(p.id); btn.textContent='‚ô°'; }
      else { state.wishlist.add(p.id); btn.textContent='‚ù§Ô∏è'; }
      saveWishlist();
      updateWishBadge();
    }
    function updateWishBadge(){ el('#wishCount').textContent=state.wishlist.size; el('#wishCount').classList.toggle('hidden', state.wishlist.size===0); }

    // Cart logic
    function addToCart(p){ const item=state.cart.find(i=>i.id===p.id); if(item){ item.qty++; } else { state.cart.push({id:p.id,title:p.title,price:p.price,img:p.img,qty:1}); } renderCart(); openCart(); }

    function renderCart(){
      const wrap=el('#cartItems'); wrap.innerHTML='';
      let subtotal=0;
      state.cart.forEach(it=>{ subtotal+=it.price*it.qty; const row=document.createElement('div'); row.className='flex gap-3';
        row.innerHTML=`<div class='w-16 h-20 bg-cover bg-center rounded border' style="background-image:url('${it.img}')"></div>
          <div class='flex-1'><p class='text-sm font-medium line-clamp-2'>${it.title}</p>
            <p class='text-xs text-neutral-600'>Qty: <button class='px-2 border rounded ml-1'>-</button> <span class='mx-1'>${it.qty}</span> <button class='px-2 border rounded'>+</button></p>
            <p class='text-sm font-semibold mt-1'>${money(it.price*it.qty)}</p></div>
          <button class='text-xs underline self-start'>Remove</button>`;
        const [minus,plus]=row.querySelectorAll('button');
        const removeBtn=row.querySelector('button:last-child');
        minus.addEventListener('click',()=>{ it.qty=Math.max(1,it.qty-1); renderCart(); });
        plus.addEventListener('click',()=>{ it.qty++; renderCart(); });
        removeBtn.addEventListener('click',()=>{ state.cart = state.cart.filter(x=>x.id!==it.id); renderCart(); });
        wrap.appendChild(row);
      });
      el('#cartSubtotal').textContent=money(subtotal);
      const totalQty = state.cart.reduce((a,c)=>a+c.qty,0);
      el('#cartCount').textContent=totalQty; el('#cartCount').classList.toggle('hidden', state.cart.length===0);
    }

    // Cart drawer controls
    const cartDrawer=el('#cartDrawer');
    const openCart=()=>{ cartDrawer.style.transform='translateX(0)'; };
    const closeCart=()=>{ cartDrawer.style.transform='translateX(100%)'; };
    el('#openCart').addEventListener('click',openCart);
    el('#closeCart').addEventListener('click',closeCart);

    // Checkout linking
    el('#checkoutBtn').addEventListener('click',()=>{
      if(!CHECKOUT_URL || CHECKOUT_URL.includes('example')){
        alert('Connect to your checkout first (Razorpay/Shopify). Update CHECKOUT_URL in the script.');
      } else {
        window.location.href = CHECKOUT_URL;
      }
    });

    // Quick view
    function openQuick(p){
      el('#qvTitle').textContent=p.title;
      el('#qvImage').style.backgroundImage=`url('${p.img}')`;
      el('#qvRating').textContent=p.rating+' ‚òÖ';
      el('#qvPrice').textContent=money(p.price);
      el('#qvMrp').textContent=money(p.mrp);
      el('#qvOff').textContent=discount(p)+'% OFF';
      el('#qvDesc').textContent=p.desc;
      const sizes=el('#qvSizes'); sizes.innerHTML=''; (p.sizes||[]).forEach(s=>{ const b=document.createElement('button'); b.textContent=s; b.className='px-3 py-1 border rounded'; b.onclick=()=>{ els('#qvSizes button').forEach(x=>x.classList.remove('bg-black','text-white')); b.classList.add('bg-black','text-white'); }; sizes.appendChild(b); });
      el('#qvBadge').classList.toggle('hidden', !p.badge); el('#qvBadge').textContent=p.badge||'';
      el('#qvWish').onclick=()=>toggleWish(p,el('#qvWish'));
      el('#qvAdd').onclick=()=>{ if(p.stock>0){ addToCart(p); closeQv(); } else { openNotify(p); } };
      el('#qvWhats').href = `https://wa.me/${BUSINESS_PHONE}?text=${encodeURIComponent('Hi Sisuu, I want to buy: '+p.title+' ('+money(p.price)+')')}`;
      el('#quickModal').classList.remove('hidden'); el('#quickModal').classList.add('flex');
    }
    const closeQv=()=>{ el('#quickModal').classList.add('hidden'); el('#quickModal').classList.remove('flex'); };
    el('#closeQv').addEventListener('click',closeQv);
    el('#quickModal').addEventListener('click',e=>{ if(e.target.id==='quickModal') closeQv(); });

    // Notify Me (sold out): email + optional WhatsApp
    function openNotify(p){
      const subject = encodeURIComponent('Notify me when back in stock: '+p.title);
      const body = encodeURIComponent(`Hi Sisuu,%0D%0A%0D%0APlease notify me when this item is back in stock:%0D%0A${p.title}%0D%0APrefer WhatsApp message if possible. Thank you!`);
      const mailto = `mailto:hello@sisuu.in?subject=${subject}&body=${body}`;
      window.open(mailto,'_blank');
      const goWA = confirm('Also send a WhatsApp message to speed it up?');
      if(goWA){
        const text = encodeURIComponent(`Notify me: ${p.title}`);
        window.open(`https://wa.me/${BUSINESS_PHONE}?text=${text}`,'_blank');
      }
    }

    // Init
    document.getElementById('year').textContent=new Date().getFullYear();
    render();

    // TESTS
    function setStatus(msg, ok){
      const badge = el('#testStatus');
      if(!badge) return;
      badge.textContent = msg;
      badge.className = `fixed left-3 bottom-3 text-xs px-3 py-2 rounded-full ${ok? 'bg-green-700':'bg-red-700'} text-white opacity-90 shadow-soft`;
    }

    try {
      console.assert(typeof window.el === 'undefined', 'window.el should be undefined');

      el('#sortSelect').value = 'lth';
      el('#sortSelect').dispatchEvent(new Event('change'));
      const prices = els('#productGrid > div').map(n=>Number(n.dataset.price));
      console.assert(prices[0] <= prices[prices.length-1], 'Prices should be ascending after LTH sort');

      const r40 = els('#discFilter input').find(r=>r.value==='40');
      r40.checked = True  # This will be replaced below
    } catch(e) {
      // We'll overwrite this block after writing proper JS below.
    }
  })();
  </script>

  <script>
  // Replace the temporary Python-inserted boolean & add full tests (clean block)
  (function(){
    const el = (sel, root=document) => root.querySelector(sel);
    const els = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    function setStatus(msg, ok){
      const badge = el('#testStatus');
      if(!badge) return;
      badge.textContent = msg;
      badge.className = `fixed left-3 bottom-3 text-xs px-3 py-2 rounded-full ${ok? 'bg-green-700':'bg-red-700'} text-white opacity-90 shadow-soft`;
    }
    try {
      // Discount filter test
      const r40 = els('#discFilter input').find(r=>r.value==='40');
      if (r40) {
        r40.checked = true;
        r40.dispatchEvent(new Event('change'));
        const cards = els('#productGrid > div');
        const allOK = cards.every(n=>Number(n.dataset.discount) >= 40);
        console.assert(allOK, 'Each visible card must have ‚â•40% OFF');
      }
      setStatus('All tests passed ‚úì', true);
    } catch (e) {
      console.error(e);
      setStatus('Tests failed ‚Äî see console ‚úó', false);
    }
  })();
  </script>
</body>
</html>
